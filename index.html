<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Ø¹Ù‚Ø¯ Ø¥ÙŠØ¬Ø§Ø± Ù…Ù†ØªØ¬Ø¹</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<style>
:root{ --brand-blue:#2980b9; }
*{ box-sizing:border-box; }
body{
  font-family:'Times New Roman', Arial, Tahoma, sans-serif;
  direction:rtl; margin:0; padding:0;
  background:#fdf5e6; text-align:right;
}
.container{
  max-width:800px; margin:16px auto; padding:20px;
  background:#fff; border-radius:14px;
  border:3px solid var(--brand-blue)!important;
  box-shadow:0 0 0 3px var(--brand-blue) inset!important;
  box-sizing:border-box;
}
h1{
  text-align:center; color:#2c3e50; font-size:26px; margin:8px 0 6px;
}
.title-underline{
  width:140px; height:3px; background:var(--brand-blue);
  margin:6px auto 12px; border-radius:2px;
}
.booking-number{
  color:#e53935; font-weight:bold; font-size:22px;
  text-align:center; margin:10px 0 16px;
}
.booking-info p, .terms ul{
  font-size:16px; line-height:1.6; margin:0;
}
.info-row{ margin:6px 0; }
hr{ border:2px solid var(--brand-blue); margin:18px 0; }
.terms h3{ margin:0 0 8px; color:#2c3e50; }
.terms ul{ list-style:none; padding:0; margin:0; }
.terms li{ margin:6px 0; }
.terms li .dash{ color:var(--brand-blue); font-weight:bold; margin-left:6px; }
.contract-footer{
  text-align:center; font-size:12px; color:#555; margin-top:18px;
}
.footer-note{ margin-top:6px; color:#2c3e50; }

form{
  max-width:520px; margin:18px auto; background:#fff;
  padding:16px; border-radius:10px; box-shadow:0 4px 10px rgba(0,0,0,.07);
}
label{ display:block; margin-top:12px; font-weight:bold; color:#2c3e50; }
input, select{
  width:100%; padding:10px; margin-top:6px; border-radius:8px;
  border:1px solid #cfcfcf; font-family:'Times New Roman', Arial, Tahoma, sans-serif;
}
button[type="submit"]{
  margin-top:16px; padding:12px 18px; background:#27ae60; color:#fff;
  border:none; border-radius:10px; cursor:pointer; font-size:16px; width:100%;
}
.actions{
  display:flex; gap:10px; flex-wrap:wrap; justify-content:center; margin-top:10px;
}
.btn{
  background:var(--brand-blue); color:#fff; border:none;
  padding:12px 16px; font-size:15px; border-radius:10px; cursor:pointer; min-width:180px;
}
</style>
</head>
<body>

<form id="bookingForm">
  <label>Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†ØªØ¬Ø¹:</label>
  <select id="resortSelect" required>
    <option value="" disabled selected>Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†ØªØ¬Ø¹</option>
    <option value="Ù…Ù†ØªØ¬Ø¹ ØªØ§Ù…Ø¨Ø§">Ù…Ù†ØªØ¬Ø¹ ØªØ§Ù…Ø¨Ø§</option>
    <option value="Ù…Ù†ØªØ¬Ø¹ ÙÙŠÙˆÙ„Ø§Ø±Ø§Ù†Ø¯">Ù…Ù†ØªØ¬Ø¹ ÙÙŠÙˆÙ„Ø§Ø±Ø§Ù†Ø¯</option>
  </select>

  <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø±:</label>
  <input type="text" id="customerName" required>

  <label>Ø§Ù„Ø¹Ø±Ø¨ÙˆÙ† (Ø±ÙŠØ§Ù„):</label>
  <input type="number" id="deposit" min="0" required>

  <label>Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ (Ø±ÙŠØ§Ù„):</label>
  <input type="number" id="remaining" min="0" required>

  <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø¬Ø²:</label>
  <input type="date" id="bookingDate" required>

  <button type="submit">Ø¹Ø±Ø¶ Ø§Ù„Ø¹Ù‚Ø¯</button>
</form>

<div id="contract" class="container" style="display:none;">
  <h1 id="contractTitle"></h1>
  <div class="title-underline"></div>
  <div id="bookingNumber" class="booking-number"></div>

  <div class="booking-info" id="bookingInfo">
    <p id="infoText"></p>
  </div>

  <hr>

  <div class="terms">
    <h3>Ø§Ù„Ø´Ø±ÙˆØ·:</h3>
    <ul>
      <li><span class="dash">â€”</span> Ø§Ù„Ø¹Ø±Ø¨ÙˆÙ† ØºÙŠØ± Ù…Ø³ØªØ±Ø¯</li>
      <li><span class="dash">â€”</span> Ø§Ù„Ù…Ù†ØªØ¬Ø¹ ØºÙŠØ± Ù…Ø³Ø¤ÙˆÙ„ Ø¹Ù† ÙÙ‚Ø¯Ø§Ù† Ø§Ù„Ø£ØºØ±Ø§Ø¶ Ø§Ù„Ø´Ø®ØµÙŠØ©</li>
      <li><span class="dash">â€”</span> ÙÙŠ Ø­Ø§Ù„ Ø§Ù„Ø£Ø¶Ø±Ø§Ø± Ø§Ù„Ù…Ø§Ø¯ÙŠØ© ÙŠØªØ­Ù…Ù„ Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø± ÙƒØ§ÙØ© Ø§Ù„ØªÙƒØ§Ù„ÙŠÙ</li>
      <li><span class="dash">â€”</span> ÙŠÙ…Ù†Ø¹ Ø§Ù„ØªØ¯Ø®ÙŠÙ† Ù…Ù†Ø¹Ø§ Ø¨Ø§ØªØ§ Ø¯Ø§Ø®Ù„ ØºØ±Ù ÙˆØµØ§Ù„Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø¹ ğŸš­</li>
      <li><span class="dash">â€”</span> ÙŠØ¬Ø¨ Ø¥Ø¨Ù„Ø§Øº Ø§Ù„Ø­Ø§Ø±Ø³ ÙˆÙ‚Øª Ø§Ù„Ø®Ø±ÙˆØ¬ Ù„Ø¥Ø®Ù„Ø§Ø¡ Ù…Ø³Ø¤ÙˆÙ„ÙŠØ© Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø± ÙˆÙØ­Øµ ÙˆØ§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ù…Ù†ØªØ¬Ø¹</li>
      <li><span class="dash">â€”</span> Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ§Ù„Ø®Ø±ÙˆØ¬ Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©</li>
    </ul>
    <p><strong>Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø±Ø¯ Ø¨ÙƒÙ„Ù…Ø© Ù…ÙˆØ§ÙÙ‚</strong></p>
  </div>

  <div class="contract-footer" id="contractFooter"></div>

  <div class="actions">
    <button id="printBtn" class="btn">Ø­ÙØ¸ ÙƒÙ€ PDF</button>
    <button id="saveImageBtn" class="btn">Ø­ÙØ¸ ÙƒØµÙˆØ±Ø© Ù„Ù„ÙˆØ§ØªØ³</button>
    <button id="calendarBtn" class="btn">Ø£Ø¶Ù Ø¥Ù„Ù‰ Google Calendar</button>
    <button id="calendarICSBtn" class="btn">ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù Ø§Ù„ØªÙ‚ÙˆÙŠÙ… (.ics)</button>
  </div>
</div>

<script>
const form=document.getElementById('bookingForm');
const contract=document.getElementById('contract');
const infoText=document.getElementById('infoText');
const printBtn=document.getElementById('printBtn');
const saveImageBtn=document.getElementById('saveImageBtn');
const calendarBtn=document.getElementById('calendarBtn');
const calendarICSBtn=document.getElementById('calendarICSBtn');
const contractFooter=document.getElementById('contractFooter');
const contractTitle=document.getElementById('contractTitle');
const bookingNumberEl=document.getElementById('bookingNumber');

function getDayName(d){return ["Ø§Ù„Ø£Ø­Ø¯","Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†","Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡","Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡","Ø§Ù„Ø®Ù…ÙŠØ³","Ø§Ù„Ø¬Ù…Ø¹Ø©","Ø§Ù„Ø³Ø¨Øª"][new Date(d).getDay()];}
function todayStr(){let t=new Date();return `${String(t.getDate()).padStart(2,'0')}-${String(t.getMonth()+1).padStart(2,'0')}-${t.getFullYear()}`;}

form.addEventListener('submit',e=>{
 e.preventDefault();
 const resort=document.getElementById('resortSelect').value;
 const name=document.getElementById('customerName').value;
 const dep=document.getElementById('deposit').value;
 const rem=document.getElementById('remaining').value;
 const date=document.getElementById('bookingDate').value;
 contractTitle.textContent=`Ø¹Ù‚Ø¯ Ø¥ÙŠØ¬Ø§Ø± ${resort}`;
 bookingNumberEl.textContent=`Ø±Ù‚Ù… Ø§Ù„Ø­Ø¬Ø²: ${resort==='Ù…Ù†ØªØ¬Ø¹ ØªØ§Ù…Ø¨Ø§'?'0117':'201'}`;
 infoText.innerHTML=`
   <b>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø±:</b> ${name}<br>
   <b>Ø§Ù„Ø¹Ø±Ø¨ÙˆÙ†:</b> ${dep} Ø±ÙŠØ§Ù„<br>
   <b>Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ:</b> ${rem} Ø±ÙŠØ§Ù„<br><br>
   <b>ØªØ§Ø±ÙŠØ® ÙˆÙŠÙˆÙ… Ø§Ù„Ø­Ø¬Ø²:</b> ${getDayName(date)} ${date}<br><br>
   <b>Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø­Ø¬Ø²:</b> Ù…Ù† Ù£ Ù…Ø³Ø§Ø¡Ù‹ Ø¥Ù„Ù‰ Ù¦ ØµØ¨Ø§Ø­Ù‹Ø§`;
 contractFooter.innerHTML=`ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¹Ù‚Ø¯: ${todayStr()}<div class="footer-note">ØªÙ… Ø¥Ø¹Ø¯Ø§Ø¯ Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù‚Ø¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠÙ‹Ø§ â€” ${(resort==='Ù…Ù†ØªØ¬Ø¹ ØªØ§Ù…Ø¨Ø§')?'Ù…Ù†ØªØ¬Ø¹ ØªØ§Ù…Ø¨Ø§':'Ù…Ù†ØªØ¬Ø¹ ÙÙŠÙˆÙ„Ø§Ø±Ø§Ù†Ø¯'}</div>`;
 contract.style.display='block';
 window.scrollTo({top:contract.offsetTop,behavior:'smooth'});

 // PDF
 printBtn.onclick=function(){
   document.querySelector('.actions').style.display='none';
   form.style.display='none';
   const fileName=name.trim().replace(/\s+/g,'_')+'.pdf';
   html2pdf().from(contract).set({
     margin:10,
     filename:fileName,
     html2canvas:{scale:2,useCORS:true},
     jsPDF:{unit:'mm',format:'a4',orientation:'portrait'}
   }).save().then(()=>{
     document.querySelector('.actions').style.display='flex';
     form.style.display='block';
   });
 };

 // ØµÙˆØ±Ø©
 saveImageBtn.onclick=function(){
   document.querySelector('.actions').style.display='none';
   html2canvas(contract).then(canvas=>{
     canvas.toBlob(function(blob){
       const a=document.createElement('a');
       a.download=name.trim().replace(/\s+/g,'_')+'.png';
       a.href=URL.createObjectURL(blob);
       document.body.appendChild(a);a.click();document.body.removeChild(a);
       document.querySelector('.actions').style.display='flex';
     },'image/png');
   });
 };

 // Google Calendar
 calendarBtn.onclick=function(){
   const first=name.split(' ')[0];
   const desc=`Ø§Ù„Ø¹Ø±Ø¨ÙˆÙ†: ${dep} Ø±ÙŠØ§Ù„\nØ§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${rem} Ø±ÙŠØ§Ù„`;
   const start=date.replace(/-/g,'')+'T150000Z';
   const end=date.replace(/-/g,'')+'T060000Z';
   const url=`https://calendar.google.com/calendar/r/eventedit?text=Ø­Ø¬Ø²+${encodeURIComponent(first)}&dates=${start}/${end}&details=${encodeURIComponent(desc)}`;
   window.open(url,'_blank');
 };

 // Ù…Ù„Ù ICS
 calendarICSBtn.onclick=function(){
   const first=name.split(' ')[0];
   const start=date.replace(/-/g,'')+'T150000';
   const end=date.replace(/-/g,'')+'T060000';
   const ics=`BEGIN:VCALENDAR
VERSION:2.0
BEGIN:VEVENT
SUMMARY:Ø­Ø¬Ø² ${first}
DESCRIPTION:Ø§Ù„Ø¹Ø±Ø¨ÙˆÙ†: ${dep} Ø±ÙŠØ§Ù„\\nØ§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${rem} Ø±ÙŠØ§Ù„
DTSTART:${start}
DTEND:${end}
END:VEVENT
END:VCALENDAR`.trim();
   const blob=new Blob([ics],{type:'text/calendar'});
   const a=document.createElement('a');
   a.href=URL.createObjectURL(blob);
   a.download=name.trim().replace(/\s+/g,'_')+'.ics';
   document.body.appendChild(a);a.click();document.body.removeChild(a);
 };
});
</script>

</body>
</html>
